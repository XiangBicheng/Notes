# 3.4 迭代器介绍

- 尽管我们可以使用下标访问字符串或者vector的元素，但迭代器是完成这种操作的更加通用的机制。除了vector，标准库中还实现了其他类型的容器，其中仅有部分支持下标运算，但却均支持迭代器；仅有部分实现了<运算符，但却都定义了==和!=。所以，在某些情况下，比如for循环的条件判断语句中，通常使用迭代器和\=\=或者!\=\=代替C或Java中的<运算符，这样就不用在意用的到底是哪种类型。上述称之为**泛型编程**。

## 3.4.1 使用迭代器

- 类似于指针类型，迭代器也提供了对对象的间接访问。就迭代器而言，其对象是容器中的元素或string对象中的元素。（技术上来说，尽管string不属于容器类型，但它支持很多与容器类型类似的操作）。

- 不同于指针类型，获取迭代器不是使用取地址符，因为具有迭代器的类型同时拥有返回迭代器的成员函数，调用这些成员函数即可获取指向对应容器元素的迭代器，如**begin**和**end**。begin返回指向第一个元素或第一个字符的迭代器，end返回指向容器**尾元素下一位置**的迭代器，称为尾后迭代器。如果容器为空，则begin和end返回的是同一个迭代器，都是尾后迭代器。

  ```c++
  auto b = v.begin(), e = v.end();
  ```

- 下表列出了标准迭代器支持的一些操作：

| 运算           | 含义                                                     |
| -------------- | -------------------------------------------------------- |
| *iter          | 返回迭代器iter所指元素的引用                             |
| iter->mem      | 解引用iter并获取该元素的名为mem的成员，等价于(*iter).mem |
| ++iter         | 令iter指向容器的下一个元素                               |
| --iter         | 令iter指向容器的上一个元素                               |
| iter1 == iter2 | 判断两个迭代器是否相等                                   |
| iter1 != iter2 | 判断两个迭代器是否不相等                                 |

- **迭代器类型**。就像不需要知道string和vector的size_type成员到底是什么类型一样，一般来说我们也无须知道迭代器的精确类型。当然，实际上那些拥有迭代器的标准库类型使用**iterator**和**const_iterator**来表示迭代器的类型：前者能读能写，后者只能读不能写。begin和end返回的具体迭代器类型由对象是否是常量决定，如果对象不是常量，如`vector<int> v;`，则返回iterator；如果对象是常量，如`const vector<int> cv;`，则返回const_iterator。然而，有时候只需要读元素，最好使用const_iterator类型。所以，C++引入了两个对应的**cbegin**和**cend**，它们与begin和end一样，只是无论对象是不是常量，都返回const_iterator类型。
- 之前介绍过**不能在range for循环中改变vector的size**，另一个限制是，**任何使用了迭代器的循环体，都不能向迭代器所属的容器添加或删除元素，这会使迭代器失效**。

## 3.4.2 迭代器运算

- **string和vector**的迭代器提供了更多额外的运算符，以支持对这二者所属迭代器的更加灵活的操作：

  | 运算              | 含义                                                       |
  | ----------------- | ---------------------------------------------------------- |
  | iter + n          | 迭代器加上一个整数仍得迭代器，向前移动n个元素              |
  | iter - n          | 迭代器减去一个整数仍得迭代器，向后移动n个元素              |
  | iter1 += n        | 迭代器加法的复合赋值语句                                   |
  | iter1 -= n        | 迭代器减法的复合赋值语句                                   |
  | iter1 - iter2     | 两个迭代器相减的结果是它们之间的距离，二者必须属于同一容器 |
  | \> 、\>= 、< 、<= | 比较两个迭代器指向位置的先后关系，二者必须属于同一容器     |

  *注意：迭代器间是没有加法操作的，只有减法操作。*

  